<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:p="http://www.springframework.org/schema/p"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
  http://www.springframework.org/schema/beans/spring-beans.xsd">

  <bean id="lockDataSource" class="com.zaxxer.hikari.HikariDataSource" destroy-method="close"
    p:jdbcUrl="jdbc:postgresql://${lock.hostname}:${lock.port}/${lock.database}"
    p:username="${lock.username}"
    p:password="${lock.password}"
    p:maximumPoolSize="${lock.max.connections:5}"
    p:connectionTimeout="${lock.connection.timeout:20000}"
    p:idleTimeout="${lock.idleTimeout:300000}"
    p:maxLifetime="${lock.maxLifeTime:1200000}"
    p:leakDetectionThreshold="${lock.leakDetectionThreshold:60000}"
    p:connectionTestQuery="select now()"></bean>

  <bean id="lockTxManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager"
    p:dataSource-ref="lockDataSource"/>

  <bean id="postgresLock" class="com.yusufaytas.dlock.jdbc.PostgresIntervalLock">
    <constructor-arg type="javax.sql.DataSource" ref="lockDataSource"/>
  </bean>
</beans>